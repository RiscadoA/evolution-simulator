class t{constructor(t,e,i,s=1){this.r=t,this.g=e,this.b=i,this.a=s}static new(e,i,s,r=1){return new t(e,i,s,r)}static random(){return new t(Math.random(),Math.random(),Math.random())}static black(){return new t(0,0,0)}static white(){return new t(1,1,1)}static transparent(){return new t(0,0,0,0)}clone(){return new t(this.r,this.g,this.b,this.a)}add(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b,this.a)}mix(e,i){return new t(this.r+(e.r-this.r)*i,this.g+(e.g-this.g)*i,this.b+(e.b-this.b)*i,this.a)}clamp(e=t.black(),i=t.white()){return new t(Math.max(e.r,Math.min(i.r,this.r)),Math.max(e.g,Math.min(i.g,this.g)),Math.max(e.b,Math.min(i.b,this.b)),Math.max(e.a,Math.min(i.a,this.a)))}}class e{constructor(t,e){this._x=t,this._y=e}get x(){return this._x}get y(){return this._y}static new(t,i){return new e(t,i)}static zero(){return new e(0,0)}static fromAngle(t){return new e(Math.cos(t),Math.sin(t))}clone(){return new e(this._x,this._y)}add(t){return new e(this._x+t._x,this._y+t._y)}sub(t){return new e(this._x-t._x,this._y-t._y)}mul(t){return new e(this._x*t,this._y*t)}div(t){return new e(this._x/t,this._y/t)}dot(t){return this._x*t._x+this._y*t._y}lengthSquared(){return this.dot(this)}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.div(this.length())}angle(t){return void 0===t?Math.atan2(this._y,this._x):Math.acos(this.dot(t)/(this.length()*t.length()))}perpendicular(){return new e(-this._y,this._x)}apply(t){const i=t.elements,s=this._x,r=this._y;return new e(i[0]*s+i[3]*r+i[6],i[1]*s+i[4]*r+i[7])}clamp(t,i){return new e(Math.max(t.x,Math.min(i.x,this._x)),Math.max(t.y,Math.min(i.y,this._y)))}abs(){return new e(Math.abs(this._x),Math.abs(this._y))}max(t){return new e(Math.max(this._x,t._x),Math.max(this._y,t._y))}min(t){return new e(Math.min(this._x,t._x),Math.min(this._y,t._y))}}class i{constructor(...t){if(9!==t.length)throw new Error("Invalid Mat3 elements array size, must be 9");this.elements=new Float32Array(t)}static new(...t){return new i(...t)}static identity(){return new i(1,0,0,0,1,0,0,0,1)}static translation(t){return new i(1,0,0,0,1,0,t.x,t.y,1)}static rotation(t){const e=Math.cos(t),s=Math.sin(t);return new i(e,s,0,-s,e,0,0,0,1)}static scale(t){return t instanceof e?new i(t.x,0,0,0,t.y,0,0,0,1):new i(t,0,0,0,t,0,0,0,1)}clone(){return new i(...Array.from(this.elements))}mul(t){const e=this.elements,s=[0,0,0,0,0,0,0,0,0];if(t instanceof i){const i=t.elements;for(let t=0;t<3;t++)for(let r=0;r<3;r++)for(let n=0;n<3;n++)s[3*t+r]+=e[3*t+n]*i[3*n+r]}else for(let i=0;i<3;i++)for(let r=0;r<3;r++)s[3*i+r]=e[3*i+r]*t;return new i(...s)}det(){const t=this.elements;let e=0;return e+=t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7],e-=t[2]*t[4]*t[6]+t[1]*t[3]*t[8]+t[0]*t[5]*t[7],e}transpose(){const t=this.elements,e=[0,0,0,0,0,0,0,0,0];for(let i=0;i<3;i++)for(let s=0;s<3;s++)e[3*i+s]=t[3*s+i];return new i(...e)}cofactor(){const t=this.elements,e=[0,0,0,0,0,0,0,0,0];for(let i=0;i<3;i++)for(let s=0;s<3;s++){const r=(i+s)%2==0?1:-1;e[3*i+s]=r*t[3*s+(i+1)%3]*t[3*(i+2)+s]}return new i(...e)}inverse(){const t=this.det();if(0==t)throw new Error("Can't find the inverse of the matrix because its determinant is zero");return this.cofactor().transpose().mul(1/t)}}class s{constructor(t,e,i){this._position=t.clone(),this._zoom=e,this._aspectRatio=i,this.updateMatrix()}get position(){return this._position.clone()}set position(t){this._position=t.clone(),this.updateMatrix()}get zoom(){return this._zoom}set zoom(t){this._zoom=t,this.updateMatrix()}get aspectRatio(){return this._aspectRatio}set aspectRatio(t){this._aspectRatio=t,this.updateMatrix()}get matrix(){return this._matrix.clone()}worldToScreen(t){return t.apply(this._matrix)}screenToWorld(t){return t.apply(this._matrix.inverse())}updateMatrix(){const t=i.translation(this._position),s=i.scale(e.new(this._zoom*this._aspectRatio,this._zoom));this._matrix=t.mul(s)}}class r{}class n extends r{constructor(t,e,i,s){super(),this.center=t.clone(),this.size=e.clone(),this.rotation=i,this.color=s.clone()}}class a extends r{constructor(t,e,i){super(),this.center=t.clone(),this.radius=e,this.color=i.clone()}}class h extends r{constructor(t,e,i,s){super(),this.start=t.clone(),this.end=e.clone(),this.thickness=i,this.color=s.clone()}}const o=new t(.3,.6,.9,1);class l extends class{constructor(t){this._canvas=t,this._camera=new s(e.zero(),.5,this._canvas.height/this._canvas.width),this._drawCommands=[],this.onResize()}drawCircle(t,e,i){this._drawCommands.push(new a(t,e,i))}drawBox(t,e,i,s){this._drawCommands.push(new n(t,e,i,s))}drawLine(t,e,i,s){this._drawCommands.push(new h(t,e,i,s))}get camera(){return this._camera}onResize(){this._canvas.width=window.innerWidth,this._canvas.height=window.innerHeight,this._camera.aspectRatio=this._canvas.height/this._canvas.width}executeCommands(t){this._drawCommands.forEach((e=>t(e)))}clearCommands(){this._drawCommands=[]}}{constructor(t,e){super(t),this._gl=e,this._drawShader=new _(this._gl,"\n      attribute vec2 position;\n\n      uniform mat3 transform;\n\n      void main() {\n        vec3 position = transform * vec3(position, 1.0);\n        gl_Position = vec4(position.xy, 0.0, 1.0);\n      }\n    ","\n      precision mediump float;\n\n      uniform vec3 color;\n\n      void main() {\n        gl_FragColor = vec4(color, 1.0);\n      }\n    "),this._drawShaderPositionLocation=this._drawShader.getAttributeLocation("position"),this._drawShaderTransformLocation=this._drawShader.getUniformLocation("transform"),this._drawShaderColorLocation=this._drawShader.getUniformLocation("color");let i=[];this._circle=[0,34],i.push(0,0);for(let t=0;t<=32;t++){const e=2*Math.PI*t/32;i.push(Math.cos(e),Math.sin(e))}this._line=[i.length/2,4],i.push(-.05,0),i.push(-.05,1),i.push(.05,1),i.push(.05,0),this._box=[i.length/2,4],i.push(-1,-1),i.push(-1,1),i.push(1,1),i.push(1,-1),this._vertexBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._vertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(i),this._gl.STATIC_DRAW)}flush(){this._gl.viewport(0,0,this._canvas.width,this._canvas.height),this._gl.clearColor(o.r,o.g,o.b,1),this._gl.clear(this._gl.COLOR_BUFFER_BIT),this._drawShader.use(),this.executeCommands(this.executeCommand.bind(this)),this.clearCommands()}executeCommand(t){if(t instanceof a){const e=i.scale(t.radius).mul(i.translation(t.center)).mul(this.camera.matrix);this._gl.uniformMatrix3fv(this._drawShaderTransformLocation,!1,e.elements),this._gl.uniform3f(this._drawShaderColorLocation,t.color.r,t.color.g,t.color.b),this._gl.enableVertexAttribArray(this._drawShaderPositionLocation),this._gl.vertexAttribPointer(this._drawShaderPositionLocation,2,this._gl.FLOAT,!1,0,0),this._gl.drawArrays(this._gl.TRIANGLE_FAN,this._circle[0],this._circle[1])}else if(t instanceof n){const e=i.scale(t.size).mul(i.rotation(t.rotation)).mul(i.translation(t.center)).mul(this.camera.matrix);this._gl.uniformMatrix3fv(this._drawShaderTransformLocation,!1,e.elements),this._gl.uniform3f(this._drawShaderColorLocation,t.color.r,t.color.g,t.color.b),this._gl.enableVertexAttribArray(this._drawShaderPositionLocation),this._gl.vertexAttribPointer(this._drawShaderPositionLocation,2,this._gl.FLOAT,!1,0,0),this._gl.drawArrays(this._gl.TRIANGLE_FAN,this._box[0],this._box[1])}else if(t instanceof h){const s=t.end.sub(t.start),r=i.translation(t.start),n=i.scale(e.new(t.thickness,s.length())),a=i.rotation(s.angle()-Math.PI/2),h=n.mul(a).mul(r).mul(this.camera.matrix);this._gl.uniformMatrix3fv(this._drawShaderTransformLocation,!1,h.elements),this._gl.uniform3f(this._drawShaderColorLocation,t.color.r,t.color.g,t.color.b),this._gl.enableVertexAttribArray(this._drawShaderPositionLocation),this._gl.vertexAttribPointer(this._drawShaderPositionLocation,2,this._gl.FLOAT,!1,0,0),this._gl.drawArrays(this._gl.TRIANGLE_FAN,this._line[0],this._line[1])}}}class _{constructor(t,e,i){if(this._gl=t,this._vertexShader=this.createShader(this._gl.VERTEX_SHADER,e),this._fragmentShader=this.createShader(this._gl.FRAGMENT_SHADER,i),this._program=this._gl.createProgram(),this._gl.attachShader(this._program,this._vertexShader),this._gl.attachShader(this._program,this._fragmentShader),this._gl.linkProgram(this._program),!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS))throw new Error(`Shader linking failed: ${this._gl.getProgramInfoLog(this._program)}`)}use(){this._gl.useProgram(this._program)}getAttributeLocation(t){return this._gl.getAttribLocation(this._program,t)}getUniformLocation(t){const e=this._gl.getUniformLocation(this._program,t);if(null===e)throw new Error(`Shader uniform ${t} not found.`);return e}createShader(t,e){const i=this._gl.createShader(t);if(this._gl.shaderSource(i,e),this._gl.compileShader(i),!this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS))throw new Error(`Shader compilation failed: ${this._gl.getShaderInfoLog(i)}`);return i}}class c{constructor(t){this._element=t}static fromSelector(t){const e=document.querySelector(t);if(null===e)throw new Error("Loading screen element not found.");return new c(e)}get loading(){return"block"===this._element.style.display}set loading(t){this._element.style.display=t?"block":"none"}}class d extends class{constructor(t){this._value=t,this._onValueChanged=new Set}get value(){return this._value}set value(t){const e=this.validate(t);this._value!==e&&(this._value=e,this._onValueChanged.forEach((t=>t(this._value))),this.updateDisplay())}addOnValueChangedCallback(t){this._onValueChanged.add(t)}removeOnValueChangedCallback(t){this._onValueChanged.delete(t)}}{constructor(t,e,i,s,r,n){super(r),this._min=e,this._max=i,this._step=s,this._type=n,this._input=t.querySelector("input"),this._input.setAttribute("min",this._min.toString()),this._input.setAttribute("min",this._max.toString()),this._input.setAttribute("step",s.toString()),this._input.addEventListener("input",(()=>{const t=parseFloat(this._input.value);switch(this._type){case"exponential":this.value=Math.pow(10,t);break;case"integer":this.value=Math.round(t);break;default:this.value=t}})),this._display=t.querySelector("span"),this.updateDisplay()}validate(t){return Math.max(this._min,Math.min(this._max,t))}updateDisplay(){"exponential"===this._type?this._input.value=Math.log10(this.value).toString():this._input.value=this.value.toString(),"integer"===this._type?this._display.innerText=this.value.toFixed(0):this._display.innerText=this.value.toPrecision(3)}}d.Builder=class{constructor(t){this._element=t,this._min=0,this._max=1,this._step=.01,this._initial=.5,this._type="linear"}min(t){return this._min=t,this._initial=Math.max(this._initial,this._min),this}max(t){return this._max=t,this._initial=Math.min(this._initial,this._max),this}step(t){return this._step=t,this._initial=Math.round((this._initial-this._min)/this._step)*this._step+this._min,this}initial(t){return this._initial=t,this}exponential(){return this._type="exponential",this}linear(){return this._type="linear",this}integer(){return this._type="integer",this}build(){return new d(this._element,this._min,this._max,this._step,this._initial,this._type)}};class u{constructor(t,e,i){if(0===t.size)throw new Error("A switch cannot be empty, toggles must be specified.");this._toggles=t,this._state=e,this._allowNone=i,this._onStateChanged=new Set,this._toggles.forEach(((t,e)=>{e===this._state?t.activated=!0:t.activated=!1,t.addOnActivatedCallback((()=>{this._state=e,this._onStateChanged.forEach((t=>t(e)))})),t.addOnDeactivatedCallback((()=>{this._state!==e||this._allowNone||(t.activated=!0)}))}))}get state(){return this._state}set state(t){if(this._state===t)return;if(""===t&&!this._allowNone)throw new Error("Cannot set the state of the switch to none.");if(""!==t&&!this._toggles.has(t))throw new Error(`Couldn't set the state of the switch to '${t}' because the toggle '${t}' hasn't been added.`);const e=this._toggles.get(this._state);void 0!==e&&(e.activated=!1);const i=this._toggles.get(t);void 0!==i&&(i.activated=!0),this._state=t,this._onStateChanged.forEach((t=>t(this._state)))}addOnStateChangedCallback(t){this._onStateChanged.add(t)}removeOnStateChangedCallback(t){this._onStateChanged.delete(t)}}u.Builder=class{constructor(){this._toggles=new Map,this._initial="",this._allowNone=!1}addToggle(t,e){return this._toggles.set(t,e),""===this._initial&&(this._initial=t),this}initial(t){if(!this._toggles.has(t))throw new Error(`Couldn't set initial activated toggle on switch because the toggle '${t}' hasn't been added.`);return this._initial=t,this}allowNone(){return this._allowNone=!0,this}build(){return new u(this._toggles,this._initial,this._allowNone)}};class m{constructor(){this.loadingScreen=c.fromSelector("div#loading");const t=document.getElementById("canvas");this._renderer=function(t){const e=t.getContext("webgl");if(null===e)throw new Error("WebGL is necessary but not supported.");return new l(t,e)}(t),window.addEventListener("resize",(()=>{this.loadingScreen.loading=!0,window.clearTimeout(this._resizeTimer),this._resizeTimer=window.setTimeout((()=>{this._renderer.onResize(),this.loadingScreen.loading=!1}),250)}))}start(){this._lastTime=0,this.loadingScreen.loading=!1,requestAnimationFrame(this.onAnimationFrame.bind(this))}animate(t){this._renderer.flush()}onAnimationFrame(t){const e=.001*(t-this._lastTime);this._lastTime=t,this.loadingScreen.loading||this.animate(e),requestAnimationFrame(this.onAnimationFrame.bind(this))}}document.addEventListener("DOMContentLoaded",(()=>{(new m).start()}));
//# sourceMappingURL=index.2606e6bb.js.map
